<VirtualHost *:80>
    ServerAdmin webmaster@localhost
    DocumentRoot /var/www/html
    
    # 启用 URL 重写
    RewriteEngine On
    
    # 允许 .htaccess 文件
    <Directory /var/www/html>
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted
        
        # 设置默认字符集
        AddDefaultCharset UTF-8
        
        # 允许跨域请求 (CORS)
        Header always set Access-Control-Allow-Origin "*"
        Header always set Access-Control-Allow-Methods "GET, POST, OPTIONS, DELETE, PUT"
        Header always set Access-Control-Allow-Headers "DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range,Authorization"
    </Directory>
    
    # 日志配置
    ErrorLog ${APACHE_LOG_DIR}/error.log
    CustomLog ${APACHE_LOG_DIR}/access.log combined
    
    # PHP 配置
    <IfModule mod_php.c>
        php_value memory_limit 256M
        php_value max_execution_time 300
        php_value upload_max_filesize 100M
        php_value post_max_size 100M
        php_value default_charset "UTF-8"
        php_value date.timezone "Asia/Shanghai"
    </IfModule>
    
    # 安全头设置
    Header always set X-Frame-Options DENY
    Header always set X-Content-Type-Options nosniff
    
    # 启用压缩
    <IfModule mod_deflate.c>
        AddOutputFilterByType DEFLATE text/plain
        AddOutputFilterByType DEFLATE text/html
        AddOutputFilterByType DEFLATE text/xml
        AddOutputFilterByType DEFLATE text/css
        AddOutputFilterByType DEFLATE application/xml
        AddOutputFilterByType DEFLATE application/xhtml+xml
        AddOutputFilterByType DEFLATE application/rss+xml
        AddOutputFilterByType DEFLATE application/javascript
        AddOutputFilterByType DEFLATE application/x-javascript
    </IfModule>
</VirtualHost>
